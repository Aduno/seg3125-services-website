<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>SEG3125 Project</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="../style.css">
        <link rel="stylesheet" href="../css/rental-style.css">
        <!-- <link href="../css/jquery.datetimepicker.css" rel="stylesheet"> -->
    </head>
    <body>
        <div class="container-fluid">
            <div class="row" id="top-bar">
                <!-- Logo and name -->
                <a class="col-6" href="../index.html">
                    <div class="logo-left">
                        <img src="../img/Tuba.svg">
                        <h3 class="logo-text">UO Instrument Services</h3>
                    </div>
                </a>
                <div class="col-6" href="../index.html">
                    <div class="logo-right">
                        <!-- Login -->
                        <a href="login.html"><img src="../img/user.svg"></a>
                        <!-- French/English button -->
                        <a href="login.html"><h3 class="language-toggle">Fr</h3></a>
                    </div>
                </div>
            </div>
            <nav class="navbar navbar-expand">
                <ul class="nav navbar-nav">
                    <li class="active" id="home"><a href="../index.html">Home</a></li>
                    <li class="nav-item dropdown" id="services">
                        <a class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" href="#">Services</a> 
                        <ul class="dropdown-menu">
                            <li class="dropdown-item"><a class="dropdown-text" href="rental.html">Rental</a></li>
                            <li class="dropdown-item"><a class="dropdown-text"href="lessons.html">Lessons</a></li>
                            <li class="dropdown-item"><a class="dropdown-text"href="repair.html">Repair</a></li>
                        </ul>
                    </li>
                    <li class="active" id="team"><a href="team.html">Our team</a></li>
                </ul>
            </nav>
        </div>
        <div class="row" id="main-container">
            <!-- Form -->
            <div class="col-9"id="main">
                <form>
                    <div class="container-fluid drop-container">
                        <label for="inst" class="form-label">Select instrument</label>
                        <select id="inst-menu">
                            
                        </select>
                    </div> 
                    <div class="container-fluid drop-container">
                        <label for="brand" class="form-label">Select brand</label>
                        <select id="brand-menu">
                            
                        </select>
                    </div> 
                    <div class="container-fluid" id="name-container">
                        <label for="name" class="form-label">Name</label>
                        <div><input class="user-input" type="text" id="name" required="required"></div>
                    </div>
                    <div class="container-fluid" id="email-container">
                        <label for="email" class="form-label">Email</label>
                        <div><input class="user-input" type="text" id="email" required="required"></div>
                    </div>
                    <div class="container-fluid" id="numer-container">
                        <label for="number" class="form-label">Phone number</label>
                        <div><input class="user-input" type="text" id="number"></div>
                    </div>
                    <label for="date" class="form-label">Rent Date</label>
                    <div class="input-group date">
                        <input type="date" id="start-picker" class="form-control" onkeydown="return false" min="">
                        <span class="input-group-append">
                            <!-- <button type="button" id="start-toggle" class="input-group-text bg-white">
                                <i class="fa fa-calendar"></i>
                            </button> -->
                        </span>
                    </div>  
                    <label for="date" class="form-label">Return Date</label>
                    <div class="input-group date">
                        <input type="date" id="end-picker" class="form-control" onkeydown="return false">
                        <span class="input-group-append">
                            <!-- <button type="button" id="end-toggle" class="input-group-text bg-white">
                                <i class="fa fa-calendar"></i>
                            </button> -->
                        </span>
                    </div>
                    <label for="price" class="form-label fw-bold">Total Price</label>
                    <h5 class="fw-bold" id="final-price"></h5>
                    <button type="submit" class="btn btn-primary" id="submit-btn">Submit</button>
                </form>
            </div>
            <!-- Rental price info -->
            <div class="col-3" id="info">
                <h2 class="fw-bold title">Rental prices</h2>
                <div class="container">
                    <!-- CHANGE THIS TO AN ACTUAL TABLE? -->
                    <ul id="price-table"> 
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Popup -->
        <div class="modal fade" id="popup" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title fw-bold" id="popupModalLabel">Confirmation</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <h5 id="modal-inst"></h5>
                  <h5 id="modal-brand"></h5>
                  <h5 id="modal-name"></h5>
                  <h5 id="modal-email"></h5>
                  <h5 id="modal-number"></h5>
                  <h5 id="modal-rent"></h5>
                  <h5 id="modal-return"></h5>
                  <h5 class="fw-bold" id="modal-price"></h5>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-primary" id="confirm-btn">Confirm</button>
                </div>
              </div>
            </div>
          </div>
        <div class="modal fade" id="confirmed" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="confirmedModalLabel">Confirmed</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <p>A confirmation email has been sent to your email</p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
        <script
        src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
        crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
        <script>
        $(document).ready(function(){
            // $('#end-picker').datetimepicker({
            // timepicker:false,
            // datepicker: true,
            // format: 'Y-m-d',
            // value: '12:00',
            // hours12: true,
            // step: 5,
            // allowTimes: ["01:00", "01:15", "01:30", "01:45", "02:00","02:15", "02:30", "02:45", "03:00","03:15","03:30",
            // "03:45", "04:00", "04:15", "04:30", "04:45", "05:00", "05:15","05:30","05:45","06:00", "06:15","06:30","06:45",
            // "07:00","07:15","07:30","07:45","08:00","08:15","08:30","08:45","09:00","09:15","09:30","09:45", "10:00",
            // "10:15","10:30","10:45","11:00","11:15","11:30", "11:45", "12:00", "12:15", "12:30", "12:45"]
            // });
            // $('#start-picker').datetimepicker({
            //     timepicker:false,
            //     datepicker: true,
            //     format: 'Y-m-d',
            //     value: '12:00',
            //     hours12: true,
            //     step: 5,
            //     allowTimes: ["01:00", "01:15", "01:30", "01:45", "02:00","02:15", "02:30", "02:45", "03:00","03:15","03:30",
            //     "03:45", "04:00", "04:15", "04:30", "04:45", "05:00", "05:15","05:30","05:45","06:00", "06:15","06:30","06:45",
            //     "07:00","07:15","07:30","07:45","08:00","08:15","08:30","08:45","09:00","09:15","09:30","09:45", "10:00",
            //     "10:15","10:30","10:45","11:00","11:15","11:30", "11:45", "12:00", "12:15", "12:30", "12:45"]
            // });


            function updateBrand(){
                var currnetInst = $('#inst-menu').val();
                var options = $('#brand-menu');
                $.getJSON("../text/prices.json", function(json){
                    priceFile = json;
                    options.empty();
                    $.each(priceFile[1][currnetInst], function(key, val){
                        options.append($("<option />").text(val));
                    })
                });
            }
            function updatePrice(){
                let d1 = new Date($('#start-picker').val());
                let d2 = new Date($('#end-picker').val());
                let days = Math.ceil((d2.getTime()-d1.getTime())/(1000*60*60*24))+1;
                let inst = $('#inst-menu').val();
                let price = parseInt(priceFile[0][inst])*days;
                $('#final-price').text('$'+price);
            }
            let priceFile;
            $.getJSON("../text/prices.json", function(json){ 
                    priceFile = json;
                    var options = $('#inst-menu');
                    var table = $('#price-table');
                    $.each(priceFile[0], function(key, data){
                        options.append($("<option />").text(key));
                        table.append($("<ul class='inst-item'/>").text(key+': $'+data+'/day'))
                    });
                    updateBrand()
                    updatePrice();
            });


            
            $('#inst-menu').change(function(){
                updateBrand();
                updatePrice();
            })
         
            $('#start-picker').change(function(){
                // $('#start-picker').datetimepicker('toggle');
                updatePrice();
            });
            $('#end-picker').change(function(){
                // $('#end-picker').datetimepicker('toggle');
                updatePrice();
            });

            // $('.user-input').val(""); // Clearing out input spaces (The datetime js is polluting the input tags with dates)

            $('#submit-btn').click(function(event){ // Setting up listener and popup 
                event.preventDefault();
                if(!$('#name').val() ||!$('#email').val()){
                    alert('Please fill out the name and email section');
                }
                else{
                // Populating all the info
                $('#modal-inst').text('Instrument: '+$('#inst-menu').val());
                $('#modal-brand').text('Brand: '+$('#brand-menu').val());
                $('#modal-name').text('Name: '+$('#name').val());
                $('#modal-email').text('Email: '+$('#email').val());
                $('#modal-number').text('Phone Number: '+$('#number').val());
                $('#modal-rent').text('Rent Date: '+$('#start-picker').val());
                $('#modal-return').text('Return Date: '+$('#end-picker').val());
                $('#modal-price').text('Total price: '+$('#final-price').text());
                $('#popup').modal('show');
                }
            });

            $('#confirm-btn').click(function(event){
                event.preventDefault();
                $('#popup').modal('toggle'); // Closing previous popup
                $('#confirmed').modal('show'); // Opening confirmation page
            })
        });            
        </script>
        <script src="../scripts/rental.js"></script>
    </body>
</html>




